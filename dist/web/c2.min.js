function c2js(n){var e=document.querySelectorAll("["+c2js.APP_NAME+"]");c2js.ready(function(t){t.each(e,function(t,e){!e.c2js&&new c2js.Init(e,n)})})}!function(s){var c,t;s.APP_NAME="c2js",s.DOC=document,s.WIN=window,(t=c||(c={})).VOLUME="_C2.VOLUME",t.MUTED="_C2.MUTED",t.TIME="_C2.CURRENT_TIME";var r,a={seeking:!(t.SRC="_C2.SOURCE"),last:void 0},o={space:[" ","spacebar"],ctrl:["ctrl","control"],alt:["alt","altgraph"],del:["del","delete"],esc:["esc","escape"],left:["left","arrowleft"],up:["up","arrowup"],right:["right","arrowright"],down:["down","arrowdown"]},u={saveWith:window.localStorage?"localStorage":"cookie",saveTime:!1,speed:{min:0,max:3}};function l(t,e){return e[t===e[0]?1:0]}function d(t){return null!=t}function f(t,e,n){return t<e?e:n<t?n:t}function h(t,e,n){if(!t)return{number:0};var i=(t+"").match(/^(\D*)(\d|\.)+(\D*)$/),r={signal:i[1],type:i[3],number:parseFloat(t)},a="%"===r.type?n:e;return a&&function(t,e){if(!t.type)return;if("number"==typeof e)return t.type="",t.number*=e/100;var n=["ms","s","m","h","d"],i=[1e3,60,60,24],r=n.indexOf(t.type),a=n.indexOf(e);t.type=e;for(;r!==a;)a<r?t.number*=i[--r]:t.number/=i[r++]}(r,a),r}function m(t){var e=[11,8];return t<3600&&(e=[14,5]),new Date(1e3*t).toISOString().substr(e[0],e[1])}s.ready=function(t){"loading"!==document.readyState?t(s.c2):document.addEventListener("DOMContentLoaded",function(){t(s.c2)})},s.toggleVal=l;var e=function(){function t(t,e){var n=this;this.cache={},this.ctrls={play:{events:{click:function(t,e){if(!e.$media.attr("src"))return e.$media.trigger("error"),void console.error("Trying to play/pause media without source.");e.media.paused?e.media.play():e.media.pause()}},media:{play:function(t,e,n){n.$all.data("play",!0)},pause:function(t,e,n){n.$all.data("play",!1)}}},stop:{events:{click:function(t,e,n){e.media.paused||e.media.pause(),n.$all.data("stop",!0),e.media.currentTime=0}},media:{play:function(t,e,n){n.$all.data("stop",!1)},"loadeddata ended abort error":function(t,e,n){e.hasStatus("stop")||(e.media.paused||e.media.pause(),n.$all.data("stop",!0))}}},move:{events:{click:function(t,e){var n=e.media.duration,i=h(p(this).data("move"),"s",n),r=i.number;i.signal&&(r=f(r+=e.media.currentTime,0,n)),e.media.currentTime=r}}},volume:{events:{click:function(t,e){var n=h(p(this).data("volume"),null,1),i=n.number;n.signal&&(i=f(i+=e.media.volume,0,1)),e.media.volume=i}}},mute:{events:{click:function(t,e){e.media.muted=!e.media.muted}},media:{"loadeddata volumechange":function(t,e,n){var i=0===e.media.volume||e.media.muted;n.$all.data("mute",i)}}},fullscreen:{ready:function(t,e,n){!function(){if(r)return r.allowed;var e,n=p(s.DOC);if(s.DOC.webkitFullscreenEnabled)e=["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitfullscreenchange","webkitfullscreenerror"];else if(s.DOC.webkitCancelFullScreen)e=["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitfullscreenchange","webkitfullscreenerror"];else if(s.DOC.mozFullScreenEnabled)e=["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozfullscreenchange","mozfullscreenerror"];else if(s.DOC.msFullscreenEnabled)e=["msRequestFullscreen","msExitFullscreen","msFullscreenElement","MSFullscreenChange","MSFullscreenError"];else{if(!s.DOC.fullscreenEnabled)return!(r={allowed:!1});e=["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenchange","fullscreenerror"]}return r={allowed:!0,enter:function(t){t[e[0]]()},leave:function(){s.DOC[e[1]]()},check:function(){return s.DOC[e[2]]},onChange:function(t){n.on(e[3],t)},onError:function(t){n.on(e[4],t)}},!0}()?n.$all.data("fullscreen","null"):(r.onChange(function(){n.$all.data("fullscreen",e.c2js===r.check())}),r.onError(function(){e.c2js===r.check()&&(alert("Fullscreen Error!"),console.error("Fullscreen Error!"))}))},events:{click:function(t,e){r.allowed&&(r.check()?r.leave():r.enter(e.c2js))}}},"time-seek":{helpers:{setTime:function(t,e){var n=parseFloat(p(t).attr("max")),i=p(t).val();e.currentTime=e.duration*i/n},setSeek:function(t,e){var n=parseFloat(p(t).attr("max")),i=e.currentTime*n/e.duration;p(t).val(i)}},ready:function(t,e,n){n.$all.each(function(t,e){p(e).attrIfNotExists("step",.1),p(e).attrIfNotExists("max",100),p(e).val(0)})},events:{"input change":function(t,e,n){n.setTime(this,e.media)},mousedown:function(){a.seeking=!0},mouseup:function(){a.seeking=!1}},media:{"loadeddata timeupdate":function(t,n,i){a.seeking||i.$all.each(function(t,e){i.setSeek(e,n.media)})}}},"volume-seek":{helpers:{setVolume:function(t,e){var n=p(t).val();if(!e.muted||n){var i=p(t).attr("max");e.volume=n/i,e.muted=!e.volume}},setSeek:function(t,e){if(e.muted)p(t).val(0);else{var n=p(t).attr("max");p(t).val(e.volume*n)}}},ready:function(t,e,n){n.$all.each(function(t,e){p(e).attrIfNotExists("step",5),p(e).attrIfNotExists("max",100),p(e).val(0)})},events:{"input change":function(t,n,i){i.$all.each(function(t,e){i.setVolume(e,n.media)})}},media:{"loadeddata volumechange":function(t,n,i){i.$all.each(function(t,e){i.setSeek(e,n.media)})}}},time:{helpers:{update:function(t,e){var n=e.currentTime,i="";"remaining"===p(t).data("time")&&(n=e.duration-e.currentTime,i="-"),p(t).text(i+m(n))}},events:{click:function(t,e,n){p(this).data("time",l(p(this).data("time"),["current","remaining"])),n.update(this,e.media)}},media:{"loadeddata stimeupdate":function(t,n,i){i.$all.each(function(t,e){i.update(e,n.media)})}}},duration:{media:{"loadeddata durationchange":function(t,r,e){e.$all.each(function(t,e){var n=r.media.duration,i=p(e).data("duration");i?p(e).attr(i,m(n)):p(e).text(m(n))})}}},loop:{events:{click:function(t,e){p(this).data("loop",e.media.loop=!e.media.loop)}}},speed:{events:{click:function(t,e){var n=e.config.speed.min,i=e.config.speed.max,r=h(p(this).data("speed"),null,1),a=r.number;r.signal&&(a=f(a+=e.media.playbackRate,n,i)),e.media.playbackRate=a}}},"hide-mouse":{helpers:{isMoving:function(t){var e=p(t).data("hide-mouse");t.c2.timer=e?h(e,"ms").number:3e3,p(t).css("cursor",t.c2.cursor)},isStopped:function(t){t.c2.timer=null,p(t).css("cursor","none")}},ready:function(t,e,n){n.$all.each(function(t,e){e.c2={id:null,timer:null,cursor:p(e).css("cursor")}})},events:{mousemove:function(t,e,n){var i=this,r=this.c2;r&&(r.timer||n.isMoving(this),r.id&&clearTimeout(r.id),r.id=setTimeout(function(){n.isStopped(i)},r.timer))}}},custom:{}};var i=this;p.fn.data=function(t,e){if(void 0===e)return p(this).attr("c2-"+t);!0===e?i.addStatus(t):!1===e&&i.rmStatus(t),p(this).attr("c2-"+t,e)},t.c2js=!0,this.status="",this.shortcuts=[],this.$c2js=p(t),this.c2js=t,this.$media=this.$c2js.findOne("video, audio"),this.media=this.$media.first(),this.$media.on("timeupdate",function(){(0|n.media.currentTime)!=(0|n.cache.currentTime)&&(n.cache.currentTime=n.media.currentTime,n.$media.trigger("stimeupdate"))}),this.config=e||{},p.each(u,function(t,e){void 0===n.config[t]&&(n.config[t]=e)}),this.initControls(),this.loadSavedInfo(),this.bindSaveEvents()}return t.prototype.searchCtrl=function(t){return this.$c2js.find("[c2-"+t+"]")},t.prototype.createHandler=function(e,n){var i=this;return function(t){e.call(this,t,i,n.helpers)}},t.prototype.addStatus=function(t){this.status+=" "+t,this.status=this.status.trim(),this.$c2js.attr("c2js",this.status)},t.prototype.rmStatus=function(t){var e=new RegExp("\\s?("+t+")");this.status=this.status.replace(e,"").trim(),this.$c2js.attr(s.APP_NAME,this.status)},t.prototype.hasStatus=function(t){return-1!==this.status.indexOf(t)},t.prototype.initControls=function(){var i=this;this.$c2js.attrIfNotExists("tabindex",-1),p.each(this.ctrls,function(t,e){var n=i.searchCtrl(t);n&&(e.helpers||(e.helpers={}),e.helpers.$all=n,i.propertyController(e),i.addShortcuts(n))}),this.redirectControlFocus(),this.bindShortcuts()},t.prototype.propertyController=function(t){t.ready&&this.bindReady(t),t.media&&this.bindMedia(t),t.events&&this.bindEvents(t)},t.prototype.bindEvents=function(n){var i=this,r=n.helpers.$all.filter(function(t,e){return!e.hasAttribute("c2-null")});p.each(n.events,function(t,e){r.on(t,i.createHandler(e,n))})},t.prototype.bindMedia=function(n){var i=this,r=this.media.buffered.length;p.each(n.media,function(t,e){e=i.createHandler(e,n),-1!==t.indexOf("loadeddata")&&r&&e(),i.$media.on(t,e)})},t.prototype.bindReady=function(t){this.createHandler(t.ready,t)()},t.prototype.addShortcuts=function(t){var r=this;t.each(function(t,e){var n,i=p(e).data("shortcuts");i&&(i=i.toLowerCase().split(" ")).forEach(function(t){(n=o[t])?n.forEach(function(t){r.shortcuts[t]=e}):r.shortcuts[t]=e})})},t.prototype.bindShortcuts=function(){var i=this;this.$c2js.on("keydown",function(t){var e,n=t.key.toLowerCase();(e=i.shortcuts[n])&&(p(e).trigger("click"),t.preventDefault())})},t.prototype.loadSavedInfo=function(){var t=this,e=this.config;if("none"!==e.saveWith){var n=this.cache.storage="cookie"===e.saveWith?p.cookie:p.storage,i=n(c.VOLUME),r=n(c.MUTED),a=n(c.SRC),o=n(c.TIME);r=!0===r||"true"===r,!this.media.src&&d(a)&&this.$media.attr("src",a);var s=function(){d(i)&&(t.media.volume=i),t.media.src===a&&d(o)&&(t.media.currentTime=parseInt(o),t.media.currentTime=parseInt(o)+.001),t.media.muted=r};this.media.buffered.length?s():this.$media.one("loadeddata",s)}},t.prototype.bindSaveEvents=function(){var t=this.config;if("none"!==t.saveWith){var n=this.cache.storage;this.$media.on("volumechange",function(){var t=this.volume,e=this.muted;n(c.VOLUME,t),n(c.MUTED,!t||e)}),t.saveTime&&(n(c.SRC,this.media.src),this.$media.on("loadeddata",function(){n(c.SRC,this.media.src)}),this.$media.on("stimeupdate ended",function(){n(c.TIME,this.currentTime)}))}},t.prototype.redirectControlFocus=function(){var t=this;this.$c2js.find("*").filter(function(t,e){return!e.firstElementChild}).on("focus",function(){t.$c2js.trigger("focus")})},t}();function p(t,e){return new p.Query(t,e||s.DOC)}s.Init=e,s.c2=p,function(e){var t=function(){function i(t,e){if("string"==typeof t){var n=t.match(/^([#.]?)([-\w]+)(.*)$/);!n||n[3]?this.list=e.querySelectorAll(t):n[1]?"."===n[1]?this.list=e.getElementsByClassName(n[2]):this.list=[e.querySelector("#"+n[2])]:this.list=e.getElementsByTagName(n[2])}else t instanceof i?this.list=t.list:r(t)?this.list=t:this.list=[t]}return i.prototype.each=function(t){return o(this.list,t),this},i.prototype.on=function(n,i){return n=n.split(" "),this.each(function(t,e){n.forEach(function(t){e.addEventListener(t,i,!1)})})},i.prototype.one=function(n,i){return n=n.split(" "),i.$handler=function(t){return this.removeEventListener(t.type,i.$handler),i.apply(this,arguments)},this.each(function(t,e){n.forEach(function(t){e.addEventListener(t,i.$handler,!1)})})},i.prototype.trigger=function(n){var i;try{i=new CustomEvent(n,{bubbles:!0,cancelable:!0})}catch(t){(i=s.DOC.createEvent("CustomEvent")).initCustomEvent(n,!0,!0,"CustomEvent")}return this.each(function(t,e){if("focus"===n)return e.focus();e.dispatchEvent(i)})},i.prototype.empty=function(){return!this.list.length},i.prototype.attr=function(n,i){if(!this.empty())return a(i)?this.each(function(t,e){e.setAttribute(n,i+"")}):this.first().getAttribute(n)},i.prototype.attrIfNotExists=function(n,i){return this.each(function(t,e){e.getAttribute(n)||e.setAttribute(n,i)})},i.prototype.prop=function(n,i){if(!this.empty())return a(i)?this.each(function(t,e){e[n]=i}):this.first()[n]},i.prototype.val=function(t){if(!a(t))return this.prop("value");this.prop("value",t)},i.prototype.text=function(n){if(a(n))return this.each(function(t,e){e.textContent=n});var i="";return this.each(function(t,e){i+=e.textContent}),i.trim()||void 0},i.prototype.css=function(n,i){var r=this;if("string"!=typeof n)return o(n,function(t,e){r.css(t,e)}),this;if(a(i))return"number"==typeof n&&(i+="px"),this.each(function(t,e){e.style[n]=i});if(!this.empty()){var t=this.first(),e=t.ownerDocument.defaultView;return e&&e.getComputedStyle?e.getComputedStyle(t,void 0).getPropertyValue(n):t.currentStyle?t.currentStyle[n]:t.style[n]}},i.prototype.find=function(t){return e(t,this.first())},i.prototype.findOne=function(t){return e(this.first().querySelector(t))},i.prototype.filter=function(n){var i=[];return this.each(function(t,e){n.call(e,t,e)&&i.push(e)}),e(i)},i.prototype.get=function(t){if(t<this.list.length)return this.list[t]},i.prototype.first=function(){return this.get(0)},i}();function r(t){if(Array.isArray&&Array.isArray(t))return!0;if(!t)return!1;var e=t.length;return"number"==typeof e&&(0===e||0<e&&e-1 in t)}function a(t){return void 0!==t}function o(t,e){if(r(t))for(var n=0;n<t.length;n++)e.call(t[n],n,t[n]);else for(var i in t)e.call(t[i],i,t[i]);return t}e.Query=t,e.each=o,e.storage=function(t,e){if(!a(e))return localStorage.getItem(t);localStorage.setItem(t,e)},e.cookie=function(t,e){if(a(e))s.DOC.cookie=t+"="+JSON.stringify(e)+"; path=/;";else{var n,i=t+"=";s.DOC.cookie.split(";").some(function(t){return-1!==(t=t.trim()).indexOf(i)&&(n=t.substring(i.length,t.length),!0)});try{return JSON.parse(n)}catch(t){return n}}},e.fn=t.prototype}(p=s.c2||(s.c2={}))}(c2js||(c2js={}));